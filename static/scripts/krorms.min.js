$(function(){var krorms={months:["January","February","March","April","May","June","July","August","September","October","November","December"],errors:[],isFunction:function(e){return typeof e==="function"},load:function(){$(document).on("submit",".validatable",function(e){var t=$(this);var n=window[t.attr("submit")];if(n!=undefined&&krorms.isFunction(n))n(t);if(krorms.validate(t)){var r=window[t.attr("complete")];if(r!=undefined&&krorms.isFunction(r))r(t);if(t.hasClass("preventDefault"))e.preventDefault()}else{e.preventDefault();var i=window[t.attr("error")];if(i!=undefined&&krorms.isFunction(i))i(krorms.errors)}});$.fn.extend({updateSelectorDays:function(){var e=this.parent(),t=this.val(),n=1,r=e.children("[type=month]").first(),i=e.children("[type=year]").first(),s=(new Date(i.val(),r.val(),0)).getDate(),o=1;this.empty();while(o<s+1){$("<option/>").val(o).html(o).appendTo(this);if(t!=null&&o>n&&o<=t)n=o;o++}this.val(n)},getDateSelectorValue:function(){var e=this,t=krorms;return t.getSelectorValue(e,"year")+"-"+t.getSelectorValue(e,"month")+"-"+t.getSelectorValue(e,"day")},updateRange:function(){var e=this.attr("range");if(e!=undefined){if(e=="months"){for(var t in krorms.months)$("<option/>").val(parseInt(t)+1).html(krorms.months[t]).appendTo(this);return}if(e=="days"){var n=this.parent(),r=this;var i=function(){r.updateSelectorDays()};n.children("[type=month]").first().on("change",i);n.children("[type=year]").first().on("change",i);return}var s=e.split("-",2),o=krorms.parseRangeValue(s[0]),u=krorms.parseRangeValue(s[1]);var a=o;if(o>u){while(a>u-1){$("<option/>").val(a).html(a).appendTo(this);a--}}else{while(a<u+1){$("<option/>").val(a).html(a).appendTo(this);a++}}if(this.attr("type")=="year")this.parent().children("[type=day]").updateSelectorDays()}},setDateSelectorValue:function(e){var t=$(this),n=e instanceof Date?[e.getFullYear(),e.getMonth()+1,e.getDate()]:e.split("-");krorms.setSelectorValue(t,"month",n[1]);krorms.setSelectorValue(t,"year",n[0]);krorms.setSelectorValue(t,"day",n[2])}});$("select").each(function(){$(this).updateRange()});$(".dateSelector").each(function(){var e=$(this),t=e.attr("date");if(t!=undefined){if(t=="now")t=new Date;e.setDateSelectorValue(t)}})},setSelectorValue:function(e,t,n){e.find('select[type="'+t+'"]').val(parseInt(n))},getSelectorValue:function(e,t){return e.children("[type="+t+"]").val()},parseRangeValue:function(valueString){valueString=valueString.replace("year",(new Date).getFullYear());return parseInt(eval(valueString))},validate:function(e){krorms.errors=[];e.find("input,textarea,select,.dateSelector").each(function(){var e=$(this);if(e.is("select")){if(e.hasClass("dateSelector"))krorms.validateDateField(e);else krorms.validateSelector(e)}else{krorms.validateField(e)}});return Object.size(krorms.errors)==0},validateSelector:function(e){if(e.find(":selected").attr("noselect")=="true")krorms.error(e,"invalid_option_selected")},validateDateField:function(e){var t=e.getDateSelectorValue().split("-"),n=e.attr("validate");if(n!==undefined){var r=(new Date(t[0],t[1]-1,t[2])).getTime(),i=new Date,s=(new Date(i.getFullYear(),i.getMonth(),i.getDate())).getTime();console.info(r);console.info(s);if(n.indexOf("=")>-1&&r==s)return;if(n.indexOf(">")>-1&&r>s)return;if(n.indexOf("<")>-1&&r<s)return;krorms.error(e,"invalid_date")}},validateField:function(e){var t=e.attr("minlength"),n=e.attr("maxlength"),r=e.val().trim(),i=r.length,s=krorms.isRequired(e);if(i==0){if(s)krorms.error(e,"required");else return}if(t!=undefined&&n!=undefined&&(i<t||i>n)){krorms.error(e,"both_length")}else{if(t!=undefined&&i<t)krorms.error(e,"min_length");if(n!=undefined&&i>n)krorms.error(e,"max_length")}var o=e.attr("validate");if(o!=undefined){if(o=="email"){if(r.match(/^\S+@\S+\.[a-zA-Z]+$/)==null)krorms.error(e,"invalid_email")}else if(o=="number"){if(r.match(/^[\d]+$/)==null)krorms.error(e,"invalid_number")}else if(o=="password"){var u=$("#"+e.attr("field"));if(u.length===0||u.val().trim()!==r)krorms.error(e,"password_mismatch")}else{if(r.match(new RegExp(o))==null)krorms.error(e,"invalid")}}},isRequired:function(e){if(!e instanceof jQuery)e=$(e);var t=e.attr("require");return t!==undefined||t=="true"},error:function(e,t){krorms.errors.push({field:e,error:t})}};krorms.load()});if(Object.size==undefined){Object.size=function(e){var t=0,n;for(n in e)if(e.hasOwnProperty(n))t++;return t}}